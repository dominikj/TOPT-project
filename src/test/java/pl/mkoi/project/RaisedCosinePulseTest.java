package pl.mkoi.project;

import com.google.common.collect.ImmutableList;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.runners.MockitoJUnitRunner;
import pl.topt.project.data.ArgumentRange;
import pl.topt.project.data.RaisedCosinePulse;

import java.util.List;

import static org.junit.Assert.assertTrue;

/**
 * Created by dominik on 28.10.17.
 */
@RunWith(MockitoJUnitRunner.class)
public class RaisedCosinePulseTest extends PulseTest {

    private final List<Double> raisedCosinePulseReferene = ImmutableList.of(
            1.2068643444332431E-19, 1.0362405651640146E-5, 2.056378076005795E-5, 3.023578472379766E-5,
            3.902147272506527E-5, 4.6588253276867024E-5, 5.264024393835725E-5, 5.692957415866208E-5,
            5.9266212321074965E-5, 5.952593770176235E-5, 5.76561360052181E-5, 5.36791676389898E-5,
            4.7693138711342894E-5, 3.986999323716943E-5, 3.0450938254765282E-5, 1.9739308297235917E-5,
            8.091068616218313E-6, -4.096755594496316E-6, -1.639935718765302E-5, -2.8378697225178673E-5,
            -3.959883796031907E-5, -4.964153111280827E-5, -5.812151357074167E-5, -6.47009612411943E-5,
            -6.910256974146824E-5, -7.112076775507124E-5, -7.063062427331705E-5, -6.759408304514424E-5,
            -6.206324418374665E-5, -5.418051129039914E-5, -4.4175529441339595E-5, -3.2358951359344416E-5,
            -1.9113182221051506E-5, -4.880363872783626E-6, 9.852037207475173E-6, 2.45675808550741E-5,
            3.8738606781743944E-5, 5.184479268795823E-5, 6.33918767990535E-5, 7.292988429079159E-5,
            8.007019951678743E-5, 8.450085168443388E-5, 8.59994302711375E-5, 8.444311683939947E-5,
            7.981541001806389E-5, 7.220922755025498E-5, 6.182619008837705E-5, 4.897202190870578E-5,
            3.404813955642186E-5, 1.7539635961570575E-5, -5.105921611965744E-19, -1.7966964944539258E-5,
            -3.572744968654878E-5, -5.263950890906724E-5, -6.807575419604355E-5, -8.144608581828938E-5,
            -9.221965818523025E-5, -9.994528128179359E-5, -1.0426949611746264E-4, -1.049516256550691E-4,
            -1.0187519230695212E-4, -9.505520637737224E-5, -8.464096339376312E-5, -7.091413791364931E-5,
            -5.4282122260726655E-5, -3.526672536198558E-5, -1.4488513719189015E-5, 7.3527623028008866E-6,
            2.9501064053101816E-5, 5.116955664196579E-5, 7.156786162944377E-5, 8.993015067804784E-5,
            1.0554310685044397E-4, 1.1777275945764645E-4, 1.260892120312202E-4, 1.3008833151827973E-4,
            1.2950954938673544E-4, 1.242490399753427E-4, 1.1436768495149842E-4, 1.0009340088029206E-4,
            8.181759442047788E-5, 6.008571049174427E-5, 3.558204622282861E-5, 9.109210502724866E-6,
            -1.8437191744978497E-5, -4.609788704897659E-5, -7.288234649045941E-5, -9.780322368692647E-5,
            -1.1991165587798301E-4, -1.3833220326972415E-4, -1.522961799801701E-4, -1.6117215127203023E-4,
            -1.6449243671976094E-4, -1.619745664883243E-4, -1.535367854422137E-4, -1.3930688333192213E-4,
            -1.1962384343196387E-4, -9.50320401239603E-5, -6.626797040233198E-5, -3.423976671442792E-5,
            2.7259942884750876E-19, 3.5287466887439235E-5, 7.038558307889301E-5, 1.0402597435760183E-4,
            1.3495320360525873E-4, 1.6196993634258182E-4, 1.8398144339100203E-4, 2.0003784794127817E-4,
            2.093725545664643E-4, 2.1143538357087886E-4, 2.0591907422420002E-4, 1.927780116701553E-4,
            1.722382695345527E-4, 1.4479833665209093E-4, 1.1122020348502249E-4, 7.251081199644217E-5,
            2.9894211215843544E-5, -1.5224901945436083E-5, -6.130525266253004E-5, -1.0671936516406022E-4,
            -1.4980867888027993E-4, -1.8894161802334353E-4, -2.225726660711836E-4, -2.493003964359384E-4,
            -2.6792237851272184E-4, -2.7748491767138776E-4, -2.773256995646902E-4, -2.671075919098214E-4,
            -2.468421066929755E-4, -2.1690133614781803E-4, -1.780175381707148E-4, -1.3126995028587367E-4,
            -7.805884331550765E-5, -2.0067272592810127E-5, 4.0788569046312644E-5, 1.0241906156540002E-4,
            1.6262919682216533E-4, 2.191928583702221E-4, 2.699309600977092E-4, 3.1279084008893957E-4,
            3.459241665938357E-4, 3.677605634773818E-4, 3.7707420793966286E-4, 3.7304079551997183E-4,
            3.552825050602266E-4, 3.2389892473148717E-4, 2.7948231148635896E-4, 2.231160393420709E-4,
            1.5635563282860926E-4, 8.119236437861896E-5, -4.872714790649219E-19, -8.453411359964686E-5,
            -1.6949183588430597E-4, -2.518185557584263E-4, -3.2842621930655435E-4, -3.963018136269647E-4,
            -4.5261773706559513E-4, -4.948402746692314E-4, -5.208323075682666E-4, -5.289464241662694E-4,
            -5.181047732965416E-4, -4.8786230440731477E-4, -4.384504723711728E-4, -3.7079903520073626E-4,
            -2.865342279596001E-4, -1.8795233759316736E-4, -7.796850975322365E-5, 3.99585346126055E-5,
            1.619243350096304E-4, 2.8369669650754495E-4, 4.008506803564358E-4, 5.089166684477234E-4,
            6.035369628963355E-4, 6.806258811577233E-4, 7.365279547753805E-4, 7.681686544405206E-4,
            7.731920591425681E-4, 7.500800710086621E-4, 6.98248152294612E-4, 6.181131230088508E-4,
            5.111292965887717E-4, 3.797901303885833E-4, 2.2759360495303886E-4, 5.8970693081579764E-5,
            -1.2082249638860683E-4, -3.0584705125897416E-4, -4.896549523293658E-4, -6.654897983810154E-4,
            -8.265090864010559E-4, -9.660215608228492E-4, -0.0010777322975630231, -0.0011559875413672965,
            -0.0011960108995047443, -0.0011941223362387935, -0.001147931528741431, -0.0010564975462272032,
            -9.204475014419928E-4, -7.420477895420924E-4, -5.252227568794286E-4, -2.755171051596089E-4,
            1.1137633807198218E-18, 2.928893258401277E-4, 5.935527553838768E-4, 8.914975566880637E-4,
            0.0011756480665099723, 0.0014346972160487687, 0.0016574885616755914, 0.001833417917564617,
            0.0019528423799836316, 0.0020074835398809204, 0.001990811049665028, 0.0018983924814408152,
            0.0017281956169369229, 0.0014808299618286071, 0.0011597153843305667, 7.711673315642128E-4,
            3.243900552099107E-4, -1.6862835558293694E-4, -6.933226304975859E-4, -0.001232859177352556,
            -0.0017685444717722419, -0.0022803269975963723, -0.002747383421847515, -0.0031487764185514863,
            -0.0034641684528549338, -0.0036745730006786806, -0.0037631222070613098, -0.0037158279704578713,
            -0.003522311964392947, -0.0031764792448550168, -0.002677109900951902, -0.002028343731101528,
            -0.0012400341931456187, -3.279498907404221E-4, 6.861953935968275E-4, 0.0017748996609167854,
            0.0029052281042800973, 0.004039373753591742, 0.005135425012995804, 0.0061483362505252255,
            0.007031091867713269, 0.0077360484483677, 0.008216433808687479, 0.008427976198867336,
            0.008330631694417568, 0.007890373116409029, 0.007080999780048537, 0.005885924126195481,
            0.004299888961980806, 0.0023305677277676348, -4.87271479064922E-18, -0.002654184609682469,
            -0.005577798858757266, -0.008699427950182373, -0.011930094154696206, -0.01516328725197218,
            -0.01827538544322, -0.021126483863403836, -0.023561639534322335, -0.025412532715761688,
            -0.02649953531654962, -0.026634167522862583, -0.025621914301841877, -0.023265364165834596,
            -0.01936762375973257, -0.013735953680819294, -0.006185563668262306, 0.003456500895269033,
            0.015347454166997388, 0.029624923240751853, 0.04640323828316696, 0.06576993830712695,
            0.08778257016791831, 0.11246585535075214, 0.13980929441536769, 0.16976527263135505,
            0.20224772247270267, 0.23713138937453468, 0.2742517366570576, 0.31340551399027483,
            0.35435200143509143, 0.3968149282010322, 0.4404850520750117, 0.48502337227715114,
            0.5300649355721221, 0.5752231830897471, 0.6200947737607557, 0.6642648098128756,
            0.7073123806382224, 0.7488163337490548, 0.7883611756673506, 0.825543001591163,
            0.8599753506539761, 0.8912948836073654, 0.9191667818323422, 0.9432897706968574,
            0.9634006763564842, 0.9792784330301192, 0.9907474674184821, 0.9976803980789356,
            1.0, 0.9976803980789355, 0.9907474674184821, 0.9792784330301186, 0.9634006763564842,
            0.9432897706968564, 0.9191667818323422, 0.8912948836073639, 0.8599753506539761,
            0.825543001591163, 0.7883611756673506, 0.7488163337490548, 0.7073123806382224,
            0.6642648098128756, 0.6200947737607557, 0.5752231830897471, 0.5300649355721221,
            0.48502337227715114, 0.4404850520750117, 0.3968149282010322, 0.35435200143508977,
            0.31340551399027483, 0.2742517366570559, 0.23713138937453468, 0.20224772247270115,
            0.16976527263135505, 0.13980929441536644, 0.11246585535075214, 0.08778257016791724,
            0.06576993830712695, 0.04640323828316613, 0.029624923240751853, 0.015347454166996831,
            0.003456500895269033, -0.006185563668262306, -0.013735953680819294, -0.01936762375973257,
            -0.023265364165834596, -0.025621914301841877, -0.026634167522862583, -0.02649953531654962,
            -0.025412532715761688, -0.023561639534322335, -0.021126483863403836, -0.01827538544322,
            -0.015163287251972033, -0.011930094154696206, -0.008699427950182251, -0.005577798858757266,
            -0.002654184609682337, -4.87271479064922E-18, 0.0023305677277677362, 0.004299888961980806,
            0.005885924126195532, 0.007080999780048537, 0.00789037311640906, 0.008330631694417568,
            0.00842797619886733, 0.008216433808687479, 0.0077360484483677, 0.007031091867713269,
            0.0061483362505252255, 0.005135425012995804, 0.004039373753591742, 0.0029052281042800973,
            0.0017748996609167854, 6.861953935968275E-4, -3.279498907404221E-4, -0.0012400341931456187,
            -0.002028343731101528, -0.002677109900951929, -0.0031764792448550168, -0.0035223119643929563,
            -0.0037158279704578713, -0.0037631222070613093, -0.0036745730006786806, -0.0034641684528549216,
            -0.0031487764185514863, -0.0027473834218474983, -0.0022803269975963723, -0.001768544471772217,
            -0.001232859177352556, -6.933226304975657E-4, -1.6862835558293694E-4, 3.243900552099107E-4,
            7.711673315642128E-4, 0.0011597153843305667, 0.0014808299618286071, 0.0017281956169369229,
            0.0018983924814408152, 0.001990811049665028, 0.0020074835398809204, 0.0019528423799836316,
            0.001833417917564617, 0.0016574885616755914, 0.0014346972160487687, 0.0011756480665099723,
            8.914975566880525E-4, 5.935527553838768E-4, 2.9288932584011087E-4);

    @Test
    public void LorentzianPulseTest() {
        RaisedCosinePulse pulse = RaisedCosinePulse.createRaisedCosinePulseForBandwidthAndMean(1.5, 1,1);
        ArgumentRange arguments = ArgumentRange.createArgumentRangeForParameters(-2, 2, 0.01);
        List<Double> values = pulse.getValuesForArgumentRange(arguments,false);

        assertTrue(roundValues(values).equals(roundValues(raisedCosinePulseReferene)));
    }
}
